<!DOCTYPE html>
<html lang="zh">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>è¿è¥é—®é¢˜åé¦ˆ</title>
Â  Â Â 
Â  Â  <script>
Â  
Â  Â  Â  Â  const ALLOWED_IPS = [
Â  Â  Â  Â  Â  Â  '180.232.127.105', // VÃ­ dá»¥ IP 1
Â  Â  Â  Â  Â  Â  '8.217.98.79','8.217.80.232'
Â  Â  Â  Â  ];

Â  Â  Â  Â  fetch('https://api.ipify.org?format=json')
Â  Â  Â  Â  Â  Â  .then(response => response.json())
Â  Â  Â  Â  Â  Â  .then(data => {
Â  Â  Â  Â  Â  Â  Â  Â  const userIP = data.ip;
Â  Â  Â  Â  Â  Â  Â  Â  // Náº¿u IP cá»§a ngÆ°á»i dÃ¹ng khÃ´ng náº±m trong danh sÃ¡ch
Â  Â  Â  Â  Â  Â  Â  Â  if (!ALLOWED_IPS.includes(userIP)) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // XÃ³a tráº¯ng web vÃ  hiá»‡n thÃ´ng bÃ¡o lá»—i
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  document.documentElement.innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <head>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <meta charset="UTF-8">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <title>Access Denied</title>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </head>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <body style="display:flex; justify-content:center; align-items:center; height:100vh; background:#f4f7f6; font-family:sans-serif; margin:0;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="text-align:center; padding: 30px; background: white; border-radius: 12px; box-shadow: 0 8px 16px rgba(0,0,0,0.1);">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h1 style="color:#e74c3c; margin-bottom: 10px; font-size: 32px;">â›” è®¿é—®è¢«æ‹’ç»</h1>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p style="color:#333; font-size: 16px; margin-top: 20px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  æ‚¨çš„IP: <b style="color: #4a90e2;">${userIP}</b><br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ä¸åœ¨å…è®¸åˆ—è¡¨ä¸­
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </body>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  })
Â  Â  Â  Â  Â  Â  .catch(error => console.error("æ— æ³•æ£€æµ‹ IP", error));
Â  Â  </script>
Â  Â  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
Â  Â  <style>
Â  Â  Â  Â  :root {
Â  Â  Â  Â  Â  Â  --primary-color: #4a90e2;
Â  Â  Â  Â  Â  Â  --bg-color: #f4f7f6;
Â  Â  Â  Â  Â  Â  --card-bg: #ffffff;
Â  Â  Â  Â  Â  Â  --text-main: #333333;
Â  Â  Â  Â  Â  Â  --border-color: #e1e4e8;
Â  Â  Â  Â  Â  Â  --btn-hover: #357ab8;
Â  Â  Â  Â  }

Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
Â  Â  Â  Â  Â  Â  background-color: var(--bg-color);
Â  Â  Â  Â  Â  Â  color: var(--text-main);
Â  Â  Â  Â  Â  Â  margin: 0;
Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  }

Â  Â  Â  Â  .container {
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  max-width: 800px;
Â  Â  Â  Â  Â  Â  background: var(--card-bg);
Â  Â  Â  Â  Â  Â  padding: 30px;
Â  Â  Â  Â  Â  Â  border-radius: 12px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 8px 16px rgba(0,0,0,0.05);
Â  Â  Â  Â  Â  Â  min-height: 400px;
Â  Â  Â  Â  }

Â  Â  Â  Â  h1 {
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  color: var(--primary-color);
Â  Â  Â  Â  Â  Â  margin-top: 0;
Â  Â  Â  Â  Â  Â  margin-bottom: 30px;
Â  Â  Â  Â  Â  Â  font-size: 28px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .view { display: none; }
Â  Â  Â  Â  .view.active { display: block; animation: fadeIn 0.3s ease; }

Â  Â  Â  Â  @keyframes fadeIn {
Â  Â  Â  Â  Â  Â  from { opacity: 0; transform: translateY(10px); }
Â  Â  Â  Â  Â  Â  to { opacity: 1; transform: translateY(0); }
Â  Â  Â  Â  }

Â  Â  Â  Â  .menu-card {
Â  Â  Â  Â  Â  Â  background-color: #fafbfc;
Â  Â  Â  Â  Â  Â  border: 1px solid var(--border-color);
Â  Â  Â  Â  Â  Â  padding: 18px 20px;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  margin-bottom: 15px;
Â  Â  Â  Â  Â  Â  font-size: 18px;
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: space-between;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  transition: all 0.2s;
Â  Â  Â  Â  }

Â  Â  Â  Â  .menu-card:hover {
Â  Â  Â  Â  Â  Â  background-color: #f1f3f5;
Â  Â  Â  Â  Â  Â  transform: translateX(5px);
Â  Â  Â  Â  Â  Â  border-color: var(--primary-color);
Â  Â  Â  Â  }

Â  Â  Â  Â  .menu-card::after {
Â  Â  Â  Â  Â  Â  content: '\276F';
Â  Â  Â  Â  Â  Â  color: #999;
Â  Â  Â  Â  Â  Â  font-size: 16px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .btn-back {
Â  Â  Â  Â  Â  Â  background-color: transparent;
Â  Â  Â  Â  Â  Â  color: var(--text-main);
Â  Â  Â  Â  Â  Â  border: 1px solid var(--border-color);
Â  Â  Â  Â  Â  Â  padding: 8px 15px;
Â  Â  Â  Â  Â  Â  border-radius: 6px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  font-size: 14px;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  display: inline-flex;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  Â  Â  Â  transition: background 0.2s;
Â  Â  Â  Â  }

Â  Â  Â  Â  .btn-back:hover {
Â  Â  Â  Â  Â  Â  background-color: #f1f3f5;
Â  Â  Â  Â  }

Â  Â  Â  Â  .detail-title {
Â  Â  Â  Â  Â  Â  color: var(--primary-color);
Â  Â  Â  Â  Â  Â  font-size: 20px;
Â  Â  Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  Â  Â  Â  padding-bottom: 10px;
Â  Â  Â  Â  Â  Â  border-bottom: 2px solid var(--border-color);
Â  Â  Â  Â  }

Â  Â  Â  Â  .search-group {
Â  Â  Â  Â  Â  Â  margin-bottom: 15px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .search-group input {
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  padding: 10px 15px;
Â  Â  Â  Â  Â  Â  border: 1px solid var(--border-color);
Â  Â  Â  Â  Â  Â  border-radius: 6px;
Â  Â  Â  Â  Â  Â  font-size: 15px;
Â  Â  Â  Â  Â  Â  box-sizing: border-box;
Â  Â  Â  Â  Â  Â  transition: border-color 0.2s;
Â  Â  Â  Â  }

Â  Â  Â  Â  .search-group input:focus {
Â  Â  Â  Â  Â  Â  outline: none;
Â  Â  Â  Â  Â  Â  border-color: var(--primary-color);
Â  Â  Â  Â  Â  Â  box-shadow: 0 0 0 2px rgba(74, 144, 226, 0.2);
Â  Â  Â  Â  }

Â  Â  Â  Â  .item-row {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: space-between;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  background: #fdfdfd;
Â  Â  Â  Â  Â  Â  border: 1px solid #eee;
Â  Â  Â  Â  Â  Â  padding: 12px 15px;
Â  Â  Â  Â  Â  Â  border-radius: 6px;
Â  Â  Â  Â  Â  Â  margin-bottom: 10px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .item-name {
Â  Â  Â  Â  Â  Â  flex-grow: 1;
Â  Â  Â  Â  Â  Â  font-size: 16px;
Â  Â  Â  Â  Â  Â  padding-right: 10px;
Â  Â  Â  Â  Â  Â  word-break: break-all;
Â  Â  Â  Â  }

Â  Â  Â  Â  .item-actions {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  gap: 8px;
Â  Â  Â  Â  Â  Â  margin-right: 15px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .btn-icon {
Â  Â  Â  Â  Â  Â  background: transparent;
Â  Â  Â  Â  Â  Â  border: 1px solid #ccc;
Â  Â  Â  Â  Â  Â  border-radius: 4px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  padding: 4px 6px;
Â  Â  Â  Â  Â  Â  font-size: 14px;
Â  Â  Â  Â  Â  Â  transition: all 0.2s;
Â  Â  Â  Â  Â  Â  color: #555;
Â  Â  Â  Â  }

Â  Â  Â  Â  .btn-icon:hover {
Â  Â  Â  Â  Â  Â  background: #e1e4e8;
Â  Â  Â  Â  Â  Â  border-color: #999;
Â  Â  Â  Â  }

Â  Â  Â  Â  .counter-group {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  gap: 15px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .btn-count {
Â  Â  Â  Â  Â  Â  width: 32px;
Â  Â  Â  Â  Â  Â  height: 32px;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  border-radius: 50%;
Â  Â  Â  Â  Â  Â  background-color: var(--primary-color);
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  font-size: 18px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  transition: background 0.2s;
Â  Â  Â  Â  }

Â  Â  Â  Â  .btn-count:hover { background-color: var(--btn-hover); }
Â  Â  Â  Â  .btn-count.minus { background-color: #e74c3c; }
Â  Â  Â  Â  .btn-count.minus:hover { background-color: #c0392b; }

Â  Â  Â  Â  .count-display {
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  font-size: 18px;
Â  Â  Â  Â  Â  Â  min-width: 30px;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  }

Â  Â  Â  Â  .add-item-group {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  gap: 10px;
Â  Â  Â  Â  Â  Â  margin-top: 20px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .add-item-group input {
Â  Â  Â  Â  Â  Â  flex-grow: 1;
Â  Â  Â  Â  Â  Â  padding: 12px;
Â  Â  Â  Â  Â  Â  border: 1px solid var(--border-color);
Â  Â  Â  Â  Â  Â  border-radius: 6px;
Â  Â  Â  Â  Â  Â  font-size: 15px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .btn-add {
Â  Â  Â  Â  Â  Â  padding: 10px 25px;
Â  Â  Â  Â  Â  Â  background-color: #2ecc71;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  border-radius: 6px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  font-size: 15px;
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  Â  Â  white-space: nowrap;
Â  Â  Â  Â  Â  Â  transition: background 0.2s;
Â  Â  Â  Â  }

Â  Â  Â  Â  .btn-add:hover { background-color: #27ae60; }

Â  Â  Â  Â  .empty-msg {
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  color: #999;
Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  Â  Â  font-style: italic;
Â  Â  Â  Â  }

Â  Â  Â  Â  .action-section {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  gap: 15px;
Â  Â  Â  Â  Â  Â  margin-top: 40px;
Â  Â  Â  Â  Â  Â  padding-top: 20px;
Â  Â  Â  Â  Â  Â  border-top: 1px dashed var(--border-color);
Â  Â  Â  Â  Â  Â  flex-wrap: wrap;
Â  Â  Â  Â  }

Â  Â  Â  Â  .btn-export, .btn-clear, .btn-sync {
Â  Â  Â  Â  Â  Â  padding: 12px 25px;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  font-size: 16px;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  transition: all 0.3s;
Â  Â  Â  Â  }

Â  Â  Â  Â  .btn-export { background-color: var(--primary-color); box-shadow: 0 4px 6px rgba(74, 144, 226, 0.3); }
Â  Â  Â  Â  .btn-export:hover { background-color: var(--btn-hover); transform: translateY(-2px); box-shadow: 0 6px 10px rgba(74, 144, 226, 0.4); }

Â  Â  Â  Â  .btn-clear { background-color: #e74c3c; box-shadow: 0 4px 6px rgba(231, 76, 60, 0.3); }
Â  Â  Â  Â  .btn-clear:hover { background-color: #c0392b; transform: translateY(-2px); box-shadow: 0 6px 10px rgba(231, 76, 60, 0.4); }

Â  Â  Â  Â  /* NÃºt Äá»“ng bá»™ má»›i */
Â  Â  Â  Â  .btn-sync { background-color: #27ae60; box-shadow: 0 4px 6px rgba(39, 174, 96, 0.3); }
Â  Â  Â  Â  .btn-sync:hover { background-color: #219a52; transform: translateY(-2px); box-shadow: 0 6px 10px rgba(39, 174, 96, 0.4); }
Â  Â  Â  Â  .btn-sync:disabled { background-color: #95a5a6; cursor: not-allowed; transform: none; box-shadow: none; }
Â  Â  </style>
</head>
<body>

Â  Â  <div class="container">
Â  Â  Â  Â  <h1>è¿è¥é—®é¢˜åé¦ˆ</h1>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <div id="home-view" class="view active">
Â  Â  Â  Â  Â  Â  <div id="menu-list"></div>

Â  Â  Â  Â  Â  Â  <div class="action-section">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn-clear" onclick="resetAllCounts()">ğŸ—‘ï¸ ä¸€é”®æ¸…é›¶</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn-export" onclick="exportToExcel()">ğŸ“¥ å¯¼å‡º</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn-sync" id="btnSync" onclick="syncToGoogleSheet()">ğŸ”„ åŒæ­¥ Google Sheet</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div id="detail-view" class="view">
Â  Â  Â  Â  Â  Â  <button class="btn-back" onclick="goBack()">ğŸ”™ è¿”å›</button>
Â  Â  Â  Â  Â  Â  <div id="detail-title" class="detail-title"></div>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <div class="search-group">
Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="search-input" placeholder="ğŸ” æœç´¢" oninput="filterItems()">
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <div id="item-list"></div>

Â  Â  Â  Â  Â  Â  <div class="add-item-group">
Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="new-item-input" placeholder="è¾“å…¥æ–°é¡¹ç›®åç§°..." onkeypress="handleKeyPress(event)">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn-add" onclick="addNewItem()">æ·»åŠ </button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <script>
Â  Â  Â  Â  // --- ğŸ›‘ THAY Báº°NG WEB APP URL Cá»¦A Báº N (Tá»ª GOOGLE APPS SCRIPT) ---
Â  Â  Â  Â  const GOOGLE_SHEET_URL = 'YOUR_WEB_APP_URL';Â 

Â  Â  Â  Â  const defaultState = [
Â  Â  Â  Â  Â  Â  { id: 0, title: "1. èµ„é‡‘ä¸åŒæ­¥ï¼ŒååŠ©å›æ”¶", items: [] },
Â  Â  Â  Â  Â  Â  { id: 1, title: "2. ä¼šå‘˜åé¦ˆèµ„é‡‘æ‰å¤±/è½¬ç§»å¼‚å¸¸", items: [] },
Â  Â  Â  Â  Â  Â  { id: 2, title: "3. æ³¨å•ç»“ç®—é”™è¯¯", items: [] },
Â  Â  Â  Â  Â  Â  { id: 3, title: "4. æ³¨å•æœªç»“ç®—é—®é¢˜", items: [] }
Â  Â  Â  Â  ];

Â  Â  Â  Â  let state = [];
Â  Â  Â  Â  let currentCategoryIndex = null;

Â  Â  Â  Â  function loadData() {
Â  Â  Â  Â  Â  Â  const savedData = localStorage.getItem('feedbackData');
Â  Â  Â  Â  Â  Â  if (savedData) {
Â  Â  Â  Â  Â  Â  Â  Â  state = JSON.parse(savedData);
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  state = JSON.parse(JSON.stringify(defaultState));
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function saveData() {
Â  Â  Â  Â  Â  Â  localStorage.setItem('feedbackData', JSON.stringify(state));
Â  Â  Â  Â  }

Â  Â  Â  Â  function renderHome() {
Â  Â  Â  Â  Â  Â  const menuList = document.getElementById('menu-list');
Â  Â  Â  Â  Â  Â  menuList.innerHTML = '';

Â  Â  Â  Â  Â  Â  state.forEach((category, index) => {
Â  Â  Â  Â  Â  Â  Â  Â  const totalCount = category.items.reduce((sum, item) => sum + item.count, 0);
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  const card = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  card.className = 'menu-card';
Â  Â  Â  Â  Â  Â  Â  Â  card.innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span>${category.title}</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span style="font-size: 14px; color: #666; font-weight: normal;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  (å·²è®°å½•: ${category.items.length} é¡¹ | æ€»è®¡: ${totalCount})
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>
Â  Â  Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  Â  Â  card.onclick = () => openCategory(index);
Â  Â  Â  Â  Â  Â  Â  Â  menuList.appendChild(card);
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }

Â  Â  Â  Â  function openCategory(index) {
Â  Â  Â  Â  Â  Â  currentCategoryIndex = index;
Â  Â  Â  Â  Â  Â  document.getElementById('home-view').classList.remove('active');
Â  Â  Â  Â  Â  Â  document.getElementById('detail-view').classList.add('active');
Â  Â  Â  Â  Â  Â  renderDetail();
Â  Â  Â  Â  }

Â  Â  Â  Â  function goBack() {
Â  Â  Â  Â  Â  Â  currentCategoryIndex = null;
Â  Â  Â  Â  Â  Â  document.getElementById('search-input').value = '';Â 
Â  Â  Â  Â  Â  Â  document.getElementById('detail-view').classList.remove('active');
Â  Â  Â  Â  Â  Â  document.getElementById('home-view').classList.add('active');
Â  Â  Â  Â  Â  Â  renderHome();
Â  Â  Â  Â  }

Â  Â  Â  Â  function filterItems() {
Â  Â  Â  Â  Â  Â  const searchTerm = document.getElementById('search-input').value.toLowerCase();
Â  Â  Â  Â  Â  Â  const rows = document.querySelectorAll('.item-row');
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  rows.forEach(row => {
Â  Â  Â  Â  Â  Â  Â  Â  const itemName = row.querySelector('.item-name').innerText.toLowerCase();
Â  Â  Â  Â  Â  Â  Â  Â  if (itemName.includes(searchTerm)) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  row.style.display = 'flex';
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  row.style.display = 'none';
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }

Â  Â  Â  Â  function renderDetail() {
Â  Â  Â  Â  Â  Â  const category = state[currentCategoryIndex];
Â  Â  Â  Â  Â  Â  document.getElementById('detail-title').innerText = category.title;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const itemList = document.getElementById('item-list');
Â  Â  Â  Â  Â  Â  itemList.innerHTML = '';

Â  Â  Â  Â  Â  Â  if (category.items.length === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  itemList.innerHTML = '<div class="empty-msg">æš‚æ— é¡¹ç›®ï¼Œè¯·åœ¨ä¸‹æ–¹æ·»åŠ ã€‚</div>';
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  category.items.forEach((item, itemIndex) => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const row = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  row.className = 'item-row';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  row.innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="item-name">${item.name}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="item-actions">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn-icon" onclick="editItem(${itemIndex})" title="ç¼–è¾‘ (Sá»­a tÃªn)">âœï¸</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn-icon" onclick="deleteItem(${itemIndex})" title="åˆ é™¤ (XÃ³a)">ğŸ—‘ï¸</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="counter-group">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn-count minus" onclick="updateCount(${itemIndex}, -1)">-</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="count-display">${item.count}</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn-count plus" onclick="updateCount(${itemIndex}, 1)">+</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  itemList.appendChild(row);
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  document.getElementById('new-item-input').value = '';
Â  Â  Â  Â  Â  Â  document.getElementById('new-item-input').focus();
Â  Â  Â  Â  Â  Â  filterItems();
Â  Â  Â  Â  }

Â  Â  Â  Â  // --- ÄÃƒ Bá»” SUNG HÃ€M Sá»¬A VÃ€ XÃ“A Bá»Š THIáº¾U ---
Â  Â  Â  Â  function editItem(itemIndex) {
Â  Â  Â  Â  Â  Â  const item = state[currentCategoryIndex].items[itemIndex];
Â  Â  Â  Â  Â  Â  const newName = prompt("è¯·è¾“å…¥æ–°çš„é¡¹ç›®åç§° (Nháº­p tÃªn má»›i cho dá»± Ã¡n):", item.name);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (newName !== null) {Â 
Â  Â  Â  Â  Â  Â  Â  Â  const trimmedName = newName.trim();
Â  Â  Â  Â  Â  Â  Â  Â  if (trimmedName !== "") {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  item.name = trimmedName;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  saveData();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  renderDetail();
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  alert("é¡¹ç›®åç§°ä¸èƒ½ä¸ºç©ºï¼(TÃªn khÃ´ng Ä‘Æ°á»£c Ä‘á»ƒ trá»‘ng!)");
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function deleteItem(itemIndex) {
Â  Â  Â  Â  Â  Â  const item = state[currentCategoryIndex].items[itemIndex];
Â  Â  Â  Â  Â  Â  const isConfirmed = confirm(`æ‚¨ç¡®å®šè¦åˆ é™¤ "${item.name}" å—ï¼Ÿ\n(Báº¡n cÃ³ cháº¯c cháº¯n muá»‘n xÃ³a má»¥c "${item.name}" khÃ´ng?)`);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (isConfirmed) {
Â  Â  Â  Â  Â  Â  Â  Â  state[currentCategoryIndex].items.splice(itemIndex, 1);
Â  Â  Â  Â  Â  Â  Â  Â  saveData();
Â  Â  Â  Â  Â  Â  Â  Â  renderDetail();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â  // --- Káº¾T THÃšC HÃ€M Bá»” SUNG ---

Â  Â  Â  Â  function updateCount(itemIndex, change) {
Â  Â  Â  Â  Â  Â  const item = state[currentCategoryIndex].items[itemIndex];
Â  Â  Â  Â  Â  Â  if (item.count + change >= 0) {
Â  Â  Â  Â  Â  Â  Â  Â  item.count += change;
Â  Â  Â  Â  Â  Â  Â  Â  saveData();Â 
Â  Â  Â  Â  Â  Â  Â  Â  renderDetail();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function addNewItem() {
Â  Â  Â  Â  Â  Â  const input = document.getElementById('new-item-input');
Â  Â  Â  Â  Â  Â  const val = input.value.trim();
Â  Â  Â  Â  Â  Â  if (val !== "") {
Â  Â  Â  Â  Â  Â  Â  Â  state[currentCategoryIndex].items.push({ name: val, count: 0 });
Â  Â  Â  Â  Â  Â  Â  Â  saveData();Â 
Â  Â  Â  Â  Â  Â  Â  Â  renderDetail();
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  alert("è¯·è¾“å…¥é¡¹ç›®åç§°ï¼");
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function handleKeyPress(e) {
Â  Â  Â  Â  Â  Â  if (e.key === 'Enter') {
Â  Â  Â  Â  Â  Â  Â  Â  addNewItem();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function resetAllCounts() {
Â  Â  Â  Â  Â  Â  const confirmReset = confirm("æ‚¨ç¡®å®šè¦å°†æ‰€æœ‰ç»Ÿè®¡æ•°æ®æ¸…é›¶å—ï¼Ÿ\n(Báº¡n cÃ³ cháº¯c cháº¯n muá»‘n Ä‘Æ°a Táº¤T Cáº¢ sá»‘ liá»‡u Ä‘áº¿m vá» 0 khÃ´ng?)");
Â  Â  Â  Â  Â  Â  if (confirmReset) {
Â  Â  Â  Â  Â  Â  Â  Â  state.forEach(category => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  category.items.forEach(item => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  item.count = 0;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  saveData();Â 
Â  Â  Â  Â  Â  Â  Â  Â  renderHome();Â 
Â  Â  Â  Â  Â  Â  Â  Â  alert("æ‰€æœ‰æ•°æ®å·²æ¸…é›¶ï¼\n(ToÃ n bá»™ sá»‘ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c Ä‘áº·t vá» 0 thÃ nh cÃ´ng!)");
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function exportToExcel() {
Â  Â  Â  Â  Â  Â  let exportData = [];
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  state.forEach(category => {
Â  Â  Â  Â  Â  Â  Â  Â  if (category.items.length === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  exportData.push({
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "åˆ†ç±»": category.title,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "è¯¦ç»†é¡¹ç›®": "æš‚æ— æ•°æ®",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "æ•°é‡": 0
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  category.items.forEach(item => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  exportData.push({
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "åˆ†ç±»": category.title,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "è¯¦ç»†é¡¹ç›®": item.name,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "æ•°é‡": item.count
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  const worksheet = XLSX.utils.json_to_sheet(exportData);
Â  Â  Â  Â  Â  Â  const wscols = [{wch: 35}, {wch: 40}, {wch: 15}];
Â  Â  Â  Â  Â  Â  worksheet['!cols'] = wscols;

Â  Â  Â  Â  Â  Â  const workbook = XLSX.utils.book_new();
Â  Â  Â  Â  Â  Â  XLSX.utils.book_append_sheet(workbook, worksheet, "é—®é¢˜ç»Ÿè®¡");

Â  Â  Â  Â  Â  Â  const date = new Date();
Â  Â  Â  Â  Â  Â  const dateString = `${date.getFullYear()}${(date.getMonth()+1).toString().padStart(2, '0')}${date.getDate().toString().padStart(2, '0')}`;
Â  Â  Â  Â  Â  Â  XLSX.writeFile(workbook, `è¿è¥é—®é¢˜ç»Ÿè®¡_${dateString}.xlsx`);
Â  Â  Â  Â  }

Â  Â  Â  Â  // --- HÃ€M Gá»¬I LÃŠN GOOGLE SHEET ---
Â  Â  Â  Â  async function syncToGoogleSheet() {
Â  Â  Â  Â  Â  Â  if (!GOOGLE_SHEET_URL || GOOGLE_SHEET_URL === 'YOUR_WEB_APP_URL') {
Â  Â  Â  Â  Â  Â  Â  Â  alert("è¯·å…ˆè®¾ç½® Google Sheet URLï¼\n(Vui lÃ²ng thiáº¿t láº­p Link Google Sheet trong code trÆ°á»›c!)");
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  const btnSync = document.getElementById('btnSync');
Â  Â  Â  Â  Â  Â  const originalText = btnSync.innerText;
Â  Â  Â  Â  Â  Â  btnSync.innerText = "â³ åŒæ­¥ä¸­... (Äang Ä‘á»“ng bá»™)";
Â  Â  Â  Â  Â  Â  btnSync.disabled = true;

Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const response = await fetch(GOOGLE_SHEET_URL, {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  method: 'POST',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  headers: { 'Content-Type': 'text/plain;charset=utf-8' },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  body: JSON.stringify(state)
Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  Â  Â  if (response.ok) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  alert("âœ… åŒæ­¥æˆåŠŸï¼æ•°æ®å·²æ›´æ–°åˆ° Google Sheetã€‚\n(Äá»“ng bá»™ thÃ nh cÃ´ng!)");
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  throw new Error('Network response was not ok');
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error('Lá»—i khi Ä‘á»“ng bá»™:', error);
Â  Â  Â  Â  Â  Â  Â  Â  alert("âŒ åŒæ­¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ– URLï¼\n(Äá»“ng bá»™ tháº¥t báº¡i, vui lÃ²ng kiá»ƒm tra máº¡ng hoáº·c Link URL!)");
Â  Â  Â  Â  Â  Â  } finally {
Â  Â  Â  Â  Â  Â  Â  Â  btnSync.innerText = originalText;
Â  Â  Â  Â  Â  Â  Â  Â  btnSync.disabled = false;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  // Khá»Ÿi cháº¡y á»©ng dá»¥ng
Â  Â  Â  Â  loadData();
Â  Â  Â  Â  renderHome();
Â  Â  </script>
</body>
</html>

láº¥y google sheet lÃ  database Ä‘á»ƒ kiá»ƒm tra cÃ¡c IP Ä‘Æ°á»£c cho phÃ©p truy cáº­p web thÃ¬ lÃ m tháº¿ nÃ o, hÆ°á»›ng dáº«n cho tÃ´i
